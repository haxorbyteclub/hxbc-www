let audioPlayerRef,zIndex=100;function updateTimeAndDate(){const e=document.getElementById("currentDate"),t=document.getElementById("currentTime"),n=new Date;e.textContent=n.toLocaleDateString(),t.textContent=n.toLocaleTimeString()}window.setupDragElement=function(e){var t=document.getElementById(e),n=0,o=0,a=0,i=0,r=t.querySelector(".title-bar");r.onmousedown=s;const d=window.innerWidth-400,l=window.innerHeight-400,u=Math.floor(Math.random()*Math.max(1,d)),c=Math.floor(Math.random()*Math.max(1,l));function s(e){if(e.target.closest('button, a, input, textarea, select, [tabindex]:not([tabindex="-1"])'))return;e.preventDefault(),t.style.zIndex=zIndex++,"touchstart"===e.type?(n=e.touches[0].clientX,o=e.touches[0].clientY):(n=e.clientX,o=e.clientY);let r=getComputedStyle(t).transform;if("none"!==r){let e=new DOMMatrixReadOnly(r);a=e.m41,i=e.m42}document.onmouseup=f,document.onmousemove=m}function m(e){let r,d;e.preventDefault(),"touchmove"===e.type?(r=e.touches[0].clientX,d=e.touches[0].clientY):(r=e.clientX,d=e.clientY);let l=a+(r-n),u=i+(d-o);l=Math.max(0,Math.min(l,window.innerWidth-t.offsetWidth)),u=Math.max(0,Math.min(u,window.innerHeight-t.offsetHeight)),t.style.transform=`translate(${l}px, ${u}px)`}function f(){document.onmouseup=null,document.onmousemove=null,document.ontouchend=null,document.ontouchmove=null}t.style.transform=`translate(${u}px, ${c}px)`,r.addEventListener("touchstart",s),r.addEventListener("touchmove",m),r.addEventListener("touchend",f)},window.bringToFront=function(e){document.getElementById(e).style.zIndex=zIndex++},document.addEventListener("click",function(e){if(e.target.classList.contains("draggable")||e.target.closest(".draggable")){e.target.closest(".draggable").style.zIndex=zIndex++}},!0),window.setupClock=function(){setInterval(updateTimeAndDate,1e3),updateTimeAndDate()},window.initializeAudioPlayer=function(e){audioPlayerRef=e},window.playAudio=function(e){stopEqualizer(),document.querySelector("audio")&&document.querySelector("audio").remove();var t=document.createElement("audio");t.src=e,t.autoplay=!0,t.loop=!1,t.style.display="none",document.body.appendChild(t),t.addEventListener("timeupdate",function(){var e=document.querySelector(".progress"),n=0;t.currentTime>0&&(n=Math.floor(100/t.duration*t.currentTime));var o=document.querySelector(".audio-current-time");o&&(o.textContent=("0"+Math.floor(t.currentTime/60)).slice(-2)+":"+("0"+Math.floor(t.currentTime%60)).slice(-2)),e&&(e.style.width=n+"%")}),t.addEventListener("ended",function(){audioPlayerRef&&audioPlayerRef.invokeMethodAsync("PlayNext")}),setTimeout(function(){animateEqualizer()},500)},window.stopAudio=function(){stopEqualizer(),document.querySelector("audio")&&document.querySelector("audio").remove()},window.playPauseAudio=function(){var e=document.querySelector("audio");e.paused?(e.play(),animateEqualizer()):(e.pause(),stopEqualizer())};var intervalIds=[];function animateEqualizer(){intervalIds.forEach(clearInterval),intervalIds=[],document.querySelectorAll(".bar").forEach(function(e){var t=setInterval(function(){e.style.height=Math.floor(100*Math.random())+"%"},Math.floor(800*Math.random()));intervalIds.push(t)})}function stopEqualizer(){intervalIds.forEach(clearInterval),intervalIds=[],document.querySelectorAll(".bar").forEach(function(e){e.style.height="0%"})}window.addEventListener("resize",function(){document.querySelectorAll(".draggable").forEach(e=>{let t=getComputedStyle(e).transform;if("none"!==t){let n=new DOMMatrixReadOnly(t),o=n.m41,a=n.m42,i=Math.min(o,window.innerWidth-e.offsetWidth),r=Math.min(a,window.innerHeight-e.offsetHeight);e.style.transform=`translate(${i}px, ${r}px)`}})}),window.changeBackground=function(e){var t=document.getElementById("wallpaper");t.classList="",t.classList.add(e)},window.triggerDownload=function(e){const t=document.createElement("a");t.href=e,t.download=e.substring(e.lastIndexOf("/")+1),document.body.appendChild(t),t.click(),document.body.removeChild(t)},window.setupIconDrag=function(){const e=document.querySelectorAll(".desktop-icon"),t=20,n=Array.from(e).map(e=>({w:e.offsetWidth,h:e.offsetHeight})),o=Math.max(...n.map(e=>e.w),0),a=Math.max(...n.map(e=>e.h),0),i=Array.from(e);for(let e=i.length-1;e>0;e--){const t=Math.floor(Math.random()*(e+1));[i[e],i[t]]=[i[t],i[e]]}i.forEach((e,n)=>{let i=!1;const r=n%2,d=Math.floor(n/2),l=t+r*(o+10),u=30+d*(a+10),c=Math.max(t,window.innerWidth-e.offsetWidth-t),s=Math.max(30,window.innerHeight-e.offsetHeight-t),m=Math.min(l,c),f=Math.min(u,s);e.style.position="absolute",e.style.left=`${m}px`,e.style.top=`${f}px`,e.style.cursor="pointer",e.addEventListener("mousedown",n=>{i=!1,e.style.cursor="grab";let o=n.clientX-e.getBoundingClientRect().left,a=n.clientY-e.getBoundingClientRect().top;const r=n=>{e.style.cursor="grabbing",((n,r)=>{i=!0;const d=Math.max(t,Math.min(n-o,window.innerWidth-e.offsetWidth-t)),l=Math.max(30,Math.min(r-a,window.innerHeight-e.offsetHeight-t));e.style.left=`${d}px`,e.style.top=`${l}px`})(n.pageX,n.pageY)},d=()=>{document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",d),e.style.cursor="pointer"};document.addEventListener("mousemove",r),document.addEventListener("mouseup",d)}),e.addEventListener("click",e=>{i&&e.stopImmediatePropagation()}),e.ondragstart=()=>!1})},window.focusElement=function(e){e&&e.focus()},window.scrollToBottom=function(e){e&&(e.scrollTop=e.scrollHeight)};